# –û–±—ä–µ–∫—Ç–Ω—ã–π –º–∞—Å—Å–∏–≤ –Ω–∞ PHP (PHP-–∫–æ–ª–ª–µ–∫—Ü–∏—è)

–ù–∞–±–æ—Ä –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è —É–¥–æ–±–Ω–æ–π –∏ –≥–∏–±–∫–æ–π —Ä–∞–±–æ—Ç—ã —Å –º–∞—Å—Å–∏–≤–∞–º–∏ –≤ –æ–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º
–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏, —ç—Ç–æ "–æ–±—ä–µ–∫—Ç–Ω—ã–π –º–∞—Å—Å–∏–≤", –∫–æ—Ç–æ—Ä–æ–≥–æ —Ç–∞–∫ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –≤ PHP.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

PHP >= 8.0

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```
composer require krugozor/cover
```

# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –í–≤–µ–¥–µ–Ω–∏–µ

–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `CoverArray`.
–í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å, –Ω–∞—Å–ª–µ–¥—É–µ–º—ã–π –æ—Ç `CoverArray` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `CoverArray` –±–µ–∑ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.

–í –¥–∞–Ω–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –∫–∞–∫ –∏ –≤ unit-—Ç–µ—Å—Ç–∞—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö `NewTypeArray`,
–Ω–∞—Å–ª–µ–¥—É–µ–º—ã–π –æ—Ç `CoverArray`:

```php
class NewTypeArray extends CoverArray {}
```

–≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ –±—ã –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≥–∏–±–∫–æ—Å—Ç—å –¥–∞–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è.
–û–±—ä–µ–∫—Ç–æ–≤, –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö –æ—Ç `CoverArray`, –≤ –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ, –æ–Ω–∏ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è
–Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤ —Å–µ–±–µ —Ä–∞–∑–Ω—É—é –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏.

–ù–∞–ø—Ä–∏–º–µ—Ä, –æ–±—ä–µ–∫—Ç—ã –∫–ª–∞—Å—Å–∞ `CoverArray` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ –∫–∞–∫ "–æ–±—ä–µ–∫—Ç–Ω—ã–π –º–∞—Å—Å–∏–≤"
–¥–ª—è –∑–∞–º–µ—â–µ–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ `array` –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞–±–æ—Ç–µ,
–≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —Ç–∏–ø, –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–π –æ—Ç `CoverArray`, –º–æ–∂–µ—Ç —Å–ª—É–∂–∏—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–∫–∏–º –ø–æ–¥–æ–±–∏–µ–º DTO
–∏–ª–∏ –ø–æ–ø—Ä–æ—Å—Ç—É –±—ã—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º —Ç–∏–ø–æ–º –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è "–≤—ã—Å—Ç—Ä–µ–ª–∞ –≤ –Ω–æ–≥—É":

```php
function foo(NewTypeArray $data) {}
```

## –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```php
class NewTypeArray extends CoverArray {}

$data = new NewTypeArray([
    'firstName' => 'Vasiliy',
    'lastName' => 'Ivanov',
    'languages' => [
        'backend' => ['PHP', 'MySql'],
        'frontend' => ['HTML', 'CSS1', 'JavaScript', 'CSS2', 'CSS3']
    ],
]);

var_dump($data);
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
object(NewTypeArray)#2 (1) {
  ["data":protected]=>
  array(3) {
    ["firstName"]=>
    string(7) "Vasiliy"
    ["lastName"]=>
    string(6) "Ivanov"
    ["languages"]=>
    object(NewTypeArray)#4 (1) {
      ["data":protected]=>
      array(2) {
        ["backend"]=>
        object(NewTypeArray)#5 (1) {
          ["data":protected]=>
          array(2) {
            [0]=>
            string(3) "PHP"
            [1]=>
            string(5) "MySql"
          }
        }
        ["frontend"]=>
        object(NewTypeArray)#6 (1) {
          ["data":protected]=>
          array(5) {
            [0]=>
            string(4) "HTML"
            [1]=>
            string(4) "CSS1"
            [2]=>
            string(10) "JavaScript"
            [3]=>
            string(4) "CSS2"
            [4]=>
            string(4) "CSS3"
          }
        }
      }
    }
  }
}
```

–ö–∞–∫ –≤–∏–¥–Ω–æ, –≤—Å–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –º–∞—Å—Å–∏–≤—ã —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏—Å—å –≤ –æ–±—ä–µ–∫—Ç—ã —Ç–∏–ø–∞ `NewTypeArray`.
–≠—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ **–ª—é–±–æ–π –º–∞—Å—Å–∏–≤, –ø–æ–ø–∞–¥–∞—é—â–∏–π –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –ø–æ–ª—É—á–∏—Ç "–æ–±–ª–æ–∂–∫—É" –≤ –≤–∏–¥–µ
–æ–±—ä–µ–∫—Ç–∞ —Ç–æ–≥–æ –∫–ª–∞—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –µ–≥–æ –∞–∫–∫—É–º—É–ª–∏—Ä—É–µ—Ç**.

–î–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ —Å–ª–æ–∂–∏–ª–∏—Å—å –≤ protected-—Å–≤–æ–π—Å—Ç–≤–∞ `$data`, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—é
–¥–∞–Ω–Ω—ã—Ö, –∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞ `CoverArray` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–µ–∑–≥—Ä–∞–Ω–∏—á–Ω—É—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π –Ω–∞–¥ —ç—Ç–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏!

## –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–µ—Ö–∞–Ω–∏–∑–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–æ–≤

–ö–ª–∞—Å—Å `CoverArray` —Å–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–≥–æ **—è–≤–Ω—ã—Ö** –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏.
–ù–æ —Å–∞–º PHP —É–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–∞—Å—Å—É —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–∞—Å—Å–∏–≤–∞–º–∏ –∏ –±—ã–ª–æ –±—ã –≥–ª—É–ø–æ –∫–∞–∂–¥—É—é –∏–∑ –Ω–∏—Ö
–ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å –Ω–∞ –æ–±—ä–µ–∫—Ç–Ω—ã–π —Å—Ç–∏–ª—å –∏–º–µ—è –ø–æ–¥ —Ä—É–∫–æ–π —Ç–∞–∫–æ–π –º–æ—â–Ω—ã–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–∞–∫ PHP.

–ü–æ—ç—Ç–æ–º—É, –≤ –∫–ª–∞—Å—Å–µ `CoverArray` –æ–±—ä—è–≤–ª–µ–Ω [–º–∞–≥–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥
`__call`](https://www.php.net/manual/en/language.oop5.overloading.php#object.call),
–∫–æ—Ç–æ—Ä—ã–π **–Ω–µ—è–≤–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –õ–Æ–ë–´–ï —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `array_`,
—É –∫–æ—Ç–æ—Ä—ã—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö —è–≤–ª—è–µ—Ç—Å—è `array` –∏ –∏–º–µ—é—â–∏–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–µ—Ä–≤–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –º–∞—Å—Å–∏–≤,
–Ω–∞–¥ –∫–æ—Ç–æ—Ä—ã–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ**:

–ü—Ä–∏–º–µ—Ä:

| –§—É–Ω–∫—Ü–∏—è                                                                 | –ü–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º, –Ω–∞–¥ –∫–æ—Ç–æ—Ä—ã–º–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ? | –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π —Ç–∏–ø —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º? | –§—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –≤—ã–∑–æ–≤ –º–∞–≥–∏—á–µ—Å–∫–æ–≥–æ –º–µ—Ç–æ–¥–∞? |
|-------------------------------------------------------------------------|--------------------------------------------------------------------------------------|-------------------------------------|--------------------------------------------------|
| `array_sum(array $array): int\|float`                                   | üü¢                                                                                   | üî¥                                  | üî¥ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —è–≤–Ω–æ –≤ –∫–æ–¥–µ)                     |
| `array_map(?callable $callback, array $array, array ...$arrays): array` | üî¥                                                                                   | üü¢                                  | üî¥ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —è–≤–Ω–æ –≤ –∫–æ–¥–µ)                     |
| `array_diff(array $array, array ...$arrays): array`                     | üü¢                                                                                   | üü¢                                  | üü¢                                               |
| `array_my_super_function (array $arr): array`                           | üü¢                                                                                   | üü¢                                  | üü¢                                               |

–≠—Ç–æ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å—é —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è method chaining
–≤ —É—Å–ª–æ–≤–∏—è—Ö –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–∞ `__call`:

```php
// all native function called from __call method!
$data->values()->reverse()->keys();
```

> –í `CoverArray` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–æ–¥–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π PHP –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–∞—Å—Å–∏–≤–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω—ã —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ `__call`.

## –ü—Ä–∏–º–µ—Ä—ã

–¢—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –ª–∏—à—å –º–∞–ª–∞—è –¥–æ–ª—è –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ —Ä–∞–±–æ—Ç—ã —Å –æ–±—ä–µ–∫—Ç–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–º `CoverArray`.
–ò–∑—É—á–∏—Ç–µ API –∫–ª–∞—Å—Å–∞ –¥–ª—è –±–æ–ª–µ–µ —É–≥–ª—É–±–ª—ë–Ω–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è.

#### –ü—Ä–∏–º–µ—Ä:

```php
$value = $data
    ->get('languages.frontend')
    ->filter(function ($value) {
        return preg_match('~CSS~', $value);
    })
    ->implode(', ');

var_dump($value);
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
string(16) "CSS1, CSS2, CSS3"
```

#### –ü—Ä–∏–º–µ—Ä:

```php
$value = $data
    ->get('languages.frontend')
    ->append('HTML 5', 'jQuey')
    ->getDataAsArray();

var_dump($value);
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
array(7) {
  [0]=>
  string(4) "HTML"
  [1]=>
  string(4) "CSS1"
  [2]=>
  string(10) "JavaScript"
  [3]=>
  string(4) "CSS2"
  [4]=>
  string(4) "CSS3"
  [5]=>
  string(6) "HTML 5"
  [6]=>
  string(5) "jQuey"
}
```

#### –ü—Ä–∏–º–µ—Ä:

```php
var_dump($data['languages']['backend'][0]);
var_dump($data->languages->backend->item(0));
var_dump($data->get('languages.backend.0'));
var_dump($data->get('languages')->item('backend')[0]);
var_dump($data->get('languages')['backend']->item(0));
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
string(3) "PHP"
string(3) "PHP"
string(3) "PHP"
string(3) "PHP"
string(3) "PHP"
```

#### –ü—Ä–∏–º–µ—Ä:

```php
var_dump($data->get('languages.backend')->getFirst());
var_dump($data->get('languages.backend')->getLast());
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
string(3) "PHP"
string(5) "MySql"
```

#### –ü—Ä–∏–º–µ—Ä:

```php
var_dump(serialize($data->get('languages.backend')));
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
string(54) "O:12:"NewTypeArray":2:{i:0;s:3:"PHP";i:1;s:5:"MySql";}"
```

#### –ü—Ä–∏–º–µ—Ä:

```php
$value = $data->get('languages')->map(function (CoverArray $lang, string $key) {
    return sprintf(
        "\n\t<li>%s (%s):\n\t%s\n\t</li>",
        $key,
        $lang->count(),
        $lang->map(fn($value): string => "\t<li>$value</li>")->implode("\n\t")
    );
})
    ->prepend("\n<ul>")
    ->append("\n</ul>")
    ->implode('');

var_dump($value);
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
string(180) "
<ul>
        <li>backend (2):
                <li>PHP</li>
                <li>MySql</li>
        </li>
        <li>frontend (5):
                <li>HTML</li>
                <li>CSS1</li>
                <li>JavaScript</li>
                <li>CSS2</li>
                <li>CSS3</li>
        </li>
</ul>"
```

#### –ü—Ä–∏–º–µ—Ä:

```php
$value = NewTypeArray::fromExplode(',', '1,1,2,1,2,2,1,,1,,,2')
    ->unique()
    ->filter()
    ->implode(',');

var_dump($value);
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
string(3) "1,2"
```

#### –ü—Ä–∏–º–µ—Ä:

```php
var_dump($data->get('languages.backend')->getDataAsArray());
var_dump($data->get('languages.backend')->reverse()->getDataAsArray());
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
array(2) {
  [0]=>
  string(3) "PHP"
  [1]=>
  string(5) "MySql"
}
array(2) {
  [0]=>
  string(5) "MySql"
  [1]=>
  string(3) "PHP"
}
```

#### –ü—Ä–∏–º–µ—Ä:

```php
var_dump($data->get('languages.backend')->in('PHP'));
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
bool(true)
```

#### –ü—Ä–∏–º–µ—Ä:

```php
$value = $data->get('languages.frontend')->diff(
    ['HTML'],
    ['CSS1', 'CSS2', 'CSS3']
)->getDataAsArray();

var_dump($value);
```

–∏–ª–∏ –¥–∞–∂–µ —Ç–∞–∫:

```php
$value = $data->get('languages.frontend')->diff(
    new NewTypeArray(['HTML']),
    new NewTypeArray(['CSS1', 'CSS2', 'CSS3'])
)->getDataAsArray();
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
array(1) {
  [2]=>
  string(10) "JavaScript"
}
```

#### –ü—Ä–∏–º–µ—Ä:

```php
$value = $data->get('languages')->mapRecursive(
    fn(mixed $value, mixed $key): string => "$key: $value"
)->getDataAsArray();

var_dump($value);
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
array(2) {
  ["backend"]=>
  array(2) {
    [0]=>
    string(6) "0: PHP"
    [1]=>
    string(8) "1: MySql"
  }
  ["frontend"]=>
  array(5) {
    [0]=>
    string(7) "0: HTML"
    [1]=>
    string(7) "1: CSS1"
    [2]=>
    string(13) "2: JavaScript"
    [3]=>
    string(7) "3: CSS2"
    [4]=>
    string(7) "4: CSS3"
  }
}
```